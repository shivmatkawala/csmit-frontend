<div class="batch-management-container">
  
  <!-- PREMIUM LOADER -->
  <div *ngIf="loading" class="loader-overlay">
    <div class="premium-spinner"></div>
  </div>

  <!-- MODERN HEADER -->
  <div class="header-section">
    <div class="title-group">
      <h1 *ngIf="!selectedBatch">
        <i class="fas fa-layer-group" style="color: var(--primary-indigo);"></i> 
        My Enrolled Batches
      </h1>
      <h1 *ngIf="selectedBatch">
        <span class="breadcrumb-link" (click)="goBackToList()">My Batches</span> 
        <i class="fas fa-chevron-right separator"></i> 
        {{ selectedBatch.batch_name }}
      </h1>
      <p class="subtitle">Track your learning journey, modules, and performance.</p>
    </div>
    <button class="btn-back-home" (click)="goHome()" *ngIf="!selectedBatch">
      <i class="fas fa-th-large"></i> Back to Dashboard
    </button>
  </div>

  <!-- BATCH LIST GRID VIEW -->
  <div class="batch-grid" *ngIf="!selectedBatch && batches.length > 0">
    <div class="batch-card" *ngFor="let batch of batches">
      <div class="card-image-wrapper">
        <div class="card-image" [style.backgroundImage]="'url(' + batch.coverImage + ')'"></div>
        <div class="card-overlay-badge">Enrolled</div>
      </div>
      
      <div class="card-content">
        <h3>{{ batch.batch_name }}</h3>
        <div class="course-meta">
          <i class="fas fa-id-badge"></i> Course Ref: {{ batch.course_id }}
        </div>
        
        <div class="card-progress-box">
          <div class="progress-label">
            <span>Course Progress</span>
            <span>{{ batch.progress }}%</span>
          </div>
          <div class="progress-track">
            <div class="progress-fill" [style.width.%]="batch.progress"></div>
          </div>
        </div>

        <div class="card-action">
          <div class="trainer-info">
            <div class="trainer-avatar">{{ batch.instructor?.charAt(0) }}</div>
            <span class="trainer-name">{{ batch.instructor }}</span>
          </div>
          <button class="btn-open" (click)="viewBatchDetails(batch)">
            View Modules <i class="fas fa-arrow-right" style="margin-left: 5px;"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- BATCH DETAIL VIEW (Appears on click) -->
  <div class="batch-detail-view" *ngIf="selectedBatch">
    
    <!-- Sidebar Navigation -->
    <aside class="detail-sidebar">
      <div class="sidebar-header">
        <span>Active Batch</span>
        <h2>{{ selectedBatch.batch_name }}</h2>
      </div>
      
      <nav class="nav-menu">
        <div class="nav-item active"><i class="fas fa-book-open"></i> Course Modules</div>
        <div class="nav-item"><i class="fas fa-calendar-check"></i> Attendance</div>
        <div class="nav-item"><i class="fas fa-tasks"></i> Assignments</div>
        <div class="nav-item"><i class="fas fa-certificate"></i> Certificates</div>
      </nav>

      <div class="instructor-brief">
        <h4>Your Mentor</h4>
        <div class="ins-profile">
          <div class="ins-avatar">{{ selectedBatch.instructor?.charAt(0) }}</div>
          <div class="ins-name">{{ selectedBatch.instructor }}</div>
          <span style="font-size: 12px; color: #94a3b8; font-weight: 600;">Full Stack Expert</span>
        </div>
        <button class="btn-contact">Get Help</button>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="detail-main">
      <div class="hero-banner" [style.backgroundImage]="'url(' + selectedBatch.coverImage + ')'">
        <div class="hero-text">
            <h2>Welcome Back!</h2>
            <p>You have completed {{ selectedBatch.progress }}% of this course. Keep it up!</p>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-icon" style="background: #eef2ff; color: #6366f1;"><i class="fas fa-video"></i></div>
          <div class="stat-data">
            <strong>18/24</strong>
            <span>Lessons Watched</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon" style="background: #ecfdf5; color: #10b981;"><i class="fas fa-clipboard-check"></i></div>
          <div class="stat-data">
            <strong>05</strong>
            <span>Tasks Pending</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon" style="background: #fff7ed; color: #f59e0b;"><i class="fas fa-medal"></i></div>
          <div class="stat-data">
            <strong>A+</strong>
            <span>Grade Score</span>
          </div>
        </div>
      </div>

      <!-- Module & Subjects List -->
      <section class="modules-container">
          <h3><i class="fas fa-stream" style="color: var(--primary-indigo);"></i> Course Curriculum</h3>
          <div class="subject-list">
              <div class="subject-item" *ngFor="let subject of selectedBatch.subjects; let i = index">
                  <div class="subject-count">{{ i + 1 }}</div>
                  <div class="subject-info">
                      <h4>{{ subject.subjectname }}</h4>
                      <p>Video Lectures • Practical Notes • Assignment</p>
                  </div>
                  <button class="btn-play" title="Start Lesson">
                    <i class="fas fa-play"></i>
                  </button>
              </div>
              <div *ngIf="!selectedBatch.subjects?.length" class="no-data" style="text-align: center; padding: 40px; color: #94a3b8;">
                <i class="fas fa-folder-open" style="font-size: 40px; margin-bottom: 10px; display: block;"></i>
                No subjects available for this course yet.
              </div>
          </div>
      </section>
    </main>

  </div>

</div>