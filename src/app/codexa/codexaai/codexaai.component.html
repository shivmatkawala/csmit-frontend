<div class="full-codexa-ai">
  <!-- Header Section -->
  <div class="codexa-header">
    <div class="header-info">
      <div class="ai-status"></div>
      <span class="header-title">Codexa AI</span>
    </div>
    <button class="clear-btn" (click)="clearChat()" title="Clear Conversation">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg>
    </button>
  </div>

  <!-- Messages Area -->
  <div class="chat-area">
    <div *ngFor="let msg of chatHistory" 
         [class.user-row]="msg.role === 'user'"
         [class.codexa-row]="msg.role === 'codexa'" 
         class="msg-row">
      
      <div class="chat-bubble" [class.user-msg]="msg.role === 'user'" [class.codexa-msg]="msg.role === 'codexa'">
        <div class="msg-content" [innerHTML]="formatMessage(msg.content)"></div>
        <div class="msg-meta">{{ msg.timestamp | date:'shortTime' }}</div>
      </div>
    </div>

    <!-- Loading Indicator -->
    <div *ngIf="isLoading" class="msg-row codexa-row">
      <div class="chat-bubble codexa-msg loading">
        <div class="typing-indicator">
          <span></span><span></span><span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Input Area -->
  <div class="input-container">
    <div class="input-wrapper">
      <textarea 
        class="codexa-input" 
        placeholder="Ask a follow-up or request help..." 
        [(ngModel)]="message" 
        (input)="onInputChange()"
        (keydown.enter)="$event.preventDefault(); sendMessage()"
      ></textarea>
      
      <button class="send-btn" [disabled]="!hasText || isLoading" (click)="sendMessage()">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
      </button>
    </div>
    <div class="footer-note">Codexa AI can make mistakes. Verify important code.</div>
  </div>
</div>