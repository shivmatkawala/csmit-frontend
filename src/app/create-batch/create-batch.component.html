<div class="form-card">

  <!-- Back Button -->
  <button (click)="goBack()" class="back-button" title="Go Back">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path fill-rule="evenodd" d="M11.03 3.25l-7.75 7.75a.75.75 0 000 1.06l7.75 7.75a.75.75 0 101.06-1.06l-6.47-6.47h13.13a.75.75 0 000-1.5H5.62l6.47-6.47a.75.75 0 00-1.06-1.06z" clip-rule="evenodd" />
      </svg>
  </button>

  <div class="header-section">
    <h2>Create New Batch</h2>
    <p>Define the schedule, mode, and start date for the new batch.</p>
  </div>

  <form #batchForm="ngForm" (ngSubmit)="onSubmit(batchForm)" class="batch-form">

    <!-- Row 1: Batch Name & Course -->
    <div class="form-row two-cols">
      
      <div class="form-group">
        <label for="batchName">Batch Name <span class="required">*</span></label>
        <input 
          id="batchName" 
          name="batchName" 
          type="text" 
          required 
          minlength="3" 
          [(ngModel)]="batchData.batchName" 
          #batchName="ngModel" 
          class="input-field" 
          placeholder="e.g. Batch B - 2025"
        />
        <div *ngIf="batchName.invalid && (batchName.dirty || batchName.touched)" class="error-message">
          Name must be at least 3 characters.
        </div>
      </div>

      <div class="form-group">
        <label for="courseId">Select Course <span class="required">*</span></label>
        <select 
          id="courseId" 
          name="courseId" 
          required 
          [(ngModel)]="batchData.courseId" 
          #courseId="ngModel" 
          class="input-field select-field"
        >
          <option [ngValue]="null" disabled>{{ courses.length === 0 ? 'Loading courses...' : '-- Select a Course --' }}</option>
          <option *ngFor="let c of courses" [ngValue]="c.courseid">{{ c.coursename }}</option>
        </select>
        <div *ngIf="courseId.invalid && (courseId.dirty || courseId.touched)" class="error-message">
          Course selection is required.
        </div>
      </div>

    </div>

    <!-- Row 2: Date, Time, Mode (3 Columns) -->
    <div class="form-row three-cols">
      
      <div class="form-group">
        <label for="startDate">Start Date <span class="required">*</span></label>
        <input 
          id="startDate" 
          name="startDate" 
          type="date" 
          required 
          [(ngModel)]="batchData.startDate" 
          #startDate="ngModel" 
          class="input-field"
        />
        <div *ngIf="startDate.invalid && (startDate.dirty || startDate.touched)" class="error-message">
          Start date is required.
        </div>
      </div>

      <div class="form-group">
        <label for="timing">Schedule <span class="required">*</span></label>
        <input 
          id="timing" 
          name="timing" 
          type="text" 
          required 
          [(ngModel)]="batchData.timing" 
          #timing="ngModel" 
          class="input-field" 
          placeholder="e.g. 10 AM - 12 PM"
        />
         <div *ngIf="timing.invalid && (timing.dirty || timing.touched)" class="error-message">
           Timing is required.
         </div>
      </div>

      <div class="form-group">
        <label for="mode">Mode <span class="required">*</span></label>
        <select 
          id="mode" 
          name="mode" 
          required 
          [(ngModel)]="batchData.mode" 
          #mode="ngModel" 
          class="input-field select-field"
        >
          <option *ngFor="let m of modeOptions" [value]="m">{{ m }}</option>
        </select>
      </div>

    </div>

    <!-- Submit Button -->
    <div>
      <button 
        type="submit" 
        [disabled]="batchForm.invalid || isSubmitting" 
        class="submit-button"
      >
        <span *ngIf="isSubmitting" class="spinner"></span>
        <span>{{ isSubmitting ? 'Creating Batch...' : 'Create Batch' }}</span>
      </button>
    </div>

  </form>
</div>