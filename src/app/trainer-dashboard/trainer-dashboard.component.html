<div class="dashboard-container">
  <div class="dashboard-wrapper">

    <!-- Header and Greeting - Tech Theme Accent (Enhanced) -->
    <header class="header-card">
      <div class="header-content">
        <h1 class="greeting-text">
          Welcome, {{ trainerName }}! ðŸš€
        </h1>
        <img [src]="profileImageUrl" alt="Profile" class="profile-image"/>
      </div>
      <p class="welcome-message">Manage your courses, code reviews, and student engagement. Let's make today productive!</p>
    </header>

    <div class="content-grid">

      <!-- Main Content Area -->
      <div class="main-content-area">

        <!-- 1. Key Metrics - Tech Focused (Enhanced Card Look) -->
        <section class="section-card">
          <h2 class="section-title">Key Performance Indicators</h2>
          <div class="metrics-grid">
            <div *ngFor="let metric of metrics" class="metric-item">
              <div class="metric-icon">{{ metric.icon }}</div>
              <p class="metric-label">{{ metric.label }}</p>
              <p class="metric-value">{{ metric.value }}</p>
            </div>
          </div>
        </section>

        <!-- 2. My Courses - Enhanced Progress Display -->
        <section class="section-card">
          <h2 class="section-title">Active Courses & Progress</h2>
          <div class="courses-list">
            <div *ngFor="let course of teachingCourses" class="course-item">
              <div class="course-info">
                <span class="course-code-badge">{{ course.id }}</span>
                <h3 class="course-title">{{ course.title }}</h3>
                <p class="students-count" style="font-size: 0.9rem; color: var(--text-secondary);">
                  <span style="color: var(--secondary-color);">{{ course.totalStudents }}</span> Active Students
                </p>
              </div>
              <div class="course-stats">
                <div class="status-badge" [ngClass]="getStatusClass(course.status)">
                  {{ course.status }}
                </div>
                <!-- Progress Bar -->
                <div class="completion-bar-container">
                  <div class="completion-bar"
                    [ngClass]="getCompletionClass(course.completion)"
                    [style.width.%]="course.completion">
                  </div>
                </div>
                <p class="completion-text">
                  Progress: {{ course.completion }}%
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- 3. Student Queries/Q&A - Real-Time Engagement -->
        <section class="section-card">
          <h2 class="section-title">Student Q&A Corner (Real-Time)</h2>

          <div class="filter-bar">
            <!-- Filter Buttons -->
            <button class="filter-button"
                    [ngClass]="{'active': queryFilter === 'All'}"
                    (click)="queryFilter = 'All'">
              All Queries ({{ allRecentStudentQueries.length }})
            </button>
            <button class="filter-button"
                    [ngClass]="{'active': queryFilter === 'Unresolved'}"
                    (click)="queryFilter = 'Unresolved'">
              Unresolved ({{ unresolvedQueryCount }})
            </button>
            <button class="filter-button"
                    [ngClass]="{'active': queryFilter === 'High Priority'}"
                    (click)="queryFilter = 'High Priority'">
              Urgent ({{ highPriorityQueryCount }})
            </button>
          </div>

          <div class="queries-list">
            <ng-container *ngIf="filteredQueries.length > 0; else noQueries">
              <div *ngFor="let query of filteredQueries"
                   class="query-item"
                   [ngClass]="{'priority-high': query.priority === 'High' && !query.resolved, 'resolved': query.resolved}">

                <div class="query-details">
                  <p class="query-title">{{ query.title }}</p>
                  <p class="query-meta">
                    <span style="color: var(--secondary-color);">{{ query.studentName }}</span> |
                    {{ query.courseId }} |
                    Priority: <strong [style.color]="query.priority === 'High' ? '#ef4444' : (query.priority === 'Medium' ? '#f59e0b' : 'var(--secondary-color)')">{{ query.priority }}</strong>
                  </p>
                </div>

                <button class="query-action-button" (click)="toggleQueryResolved(query)">
                  {{ query.resolved ? 'Mark Unresolved' : 'Resolve Query' }}
                </button>
              </div>
            </ng-container>

            <ng-template #noQueries>
              <p class="query-data-message">ðŸŽ‰ No pending queries! Everything is resolved.</p>
            </ng-template>
          </div>
        </section>

      </div>

      <!-- Sidebar Area -->
      <div class="sidebar-area">

        <!-- 4. Pending Tasks/Grading -->
        <section class="sidebar-card action-card">
          <h2 class="sidebar-title">
            <span class="sidebar-icon">ðŸš¨</span> High Priority Reviews
          </h2>
          <div class="tasks-list">
            <div *ngFor="let task of pendingTasks" class="task-item" [ngClass]="getTaskPriorityClass(task.daysDue)">
              <div class="task-details">
                <p class="task-name">{{ task.name }}</p>
                <span class="task-course">Course: {{ task.course }}</span>
              </div>
              <span class="task-due-date">Due in {{ task.daysDue }} days</span>
            </div>
          </div>
          <button class="full-width-button">
            Go to Review Center
          </button>
        </section>

        <!-- 5. Quick Actions -->
        <section class="sidebar-card action-card">
          <h2 class="sidebar-title">
            <span class="sidebar-icon">âš¡</span> Quick Actions
          </h2>
          <div class="actions-grid">
            <button class="action-button">Create New Code Challenge <span style="color: var(--secondary-color);">â†’</span></button>
            <button class="action-button">Host Live Q&A Session <span style="color: var(--secondary-color);">â†’</span></button>
            <button class="action-button">Update Course Curriculum <span style="color: var(--secondary-color);">â†’</span></button>
          </div>
        </section>

      </div>
    </div>

  </div>
</div>
